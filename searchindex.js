Search.setIndex({"docnames": ["index", "phishing"], "filenames": ["index.md", "phishing.md"], "titles": ["Welcome to yaramail\u2019s documentation!", "Automating phishing report inbox triage"], "terms": {"python": [0, 1], "packag": 0, "command": 0, "line": 0, "util": [0, 1], "scan": [0, 1], "email": [], "yara": [0, 1], "rule": [0, 1], "It": [0, 1], "ideal": 0, "autom": 0, "triag": 0, "phish": 0, "report": 0, "all": 0, "part": 0, "an": 0, "via": 0, "header": [0, 1], "remov": 0, "indent": 0, "default": [0, 1], "consist": 0, "plain": 0, "text": 0, "html": 0, "bodi": [0, 1], "convert": 0, "markdown": 0, "nest": 0, "attach": 0, "zip": 0, "includ": [0, 1], "raw": 0, "pdf": 0, "class": [0, 1], "mailscann": [0, 1], "header_rul": [0, 1], "option": [0, 1], "union": 0, "str": [0, 1], "iobas": 0, "none": [0, 1], "body_rul": [0, 1], "header_body_rul": [0, 1], "attachment_rul": [0, 1], "sourc": [0, 1], "A": [0, 1], "scaner": [], "paramet": [0, 1], "onli": [0, 1], "appli": 0, "combin": [0, 1], "each": [0, 1], "argument": 0, "can": [0, 1], "accept": 0, "path": 0, "like": [0, 1], "object": 0, "us": [0, 1], "direct": [0, 1], "you": [0, 1], "pass": [0, 1], "from": [0, 1], "other": [0, 1], "That": [0, 1], "wai": [0, 1], "divid": [0, 1], "separ": [0, 1], "see": [0, 1], "fit": [0, 1], "scan_email": [0, 1], "dict": [0, 1], "use_raw_head": 0, "bool": 0, "fals": [0, 1], "use_raw_bodi": 0, "max_zip_depth": 0, "int": 0, "list": [0, 1], "output": [0, 1], "mailsuit": [0, 1], "parse_email": [0, 1], "instead": 0, "first": 0, "number": [0, 1], "time": [0, 1], "recurs": 0, "return": [0, 1], "match": [0, 1], "dictionari": 0, "contain": [0, 1], "follow": [0, 1], "kei": [0, 1], "valu": [0, 1], "pair": [0, 1], "name": [0, 1], "The": [0, 1], "namespac": [0, 1], "meta": [0, 1], "section": [0, 1], "tag": [0, 1], "string": [0, 1], "identifi": [0, 1], "pattern": [0, 1], "item": 0, "also": [0, 1], "locat": [0, 1], "offset": [0, 1], "variabl": [0, 1], "where": 0, "wa": [0, 1], "found": [0, 1], "header_bodi": [0, 1], "filenam": 0, "exampl": 0, "evil": 0, "js": 0, "eml": 0, "usag": 0, "scanner": [0, 1], "h": 0, "v": 0, "trust": 0, "domain": [0, 1], "trusted_domain": [0, 1], "scan_path": 0, "posit": [0, 1], "wildcard": 0, "allow": [0, 1], "help": [0, 1], "show": 0, "thi": [0, 1], "messag": [0, 1], "exit": [0, 1], "version": [0, 1], "program": 0, "verbos": 0, "entir": 0, "pars": [0, 1], "o": 0, "redirect": 0, "directori": 0, "set": [0, 1], "yara_rules_dir": 0, "environ": 0, "yara_header_rul": 0, "yar": [0, 1], "yaramail_body_rul": 0, "yaramail_header_body_rul": 0, "yaramail_trusted_domain": 0, "txt": [0, 1], "recommend": [0, 1], "same": 1, "os": 0, "target": [0, 1], "potenti": [0, 1], "malwar": [0, 1], "ar": [0, 1], "consid": 0, "insid": [0, 1], "vm": 0, "addit": [0, 1], "secur": [0, 1], "some": [0, 1], "must": [0, 1], "befor": [0, 1], "sudo": 0, "apt": 0, "build": [0, 1], "essenti": 0, "libpoppl": 0, "cpp": 0, "dev": 0, "pkg": 0, "config": 0, "python3": 0, "libemail": 0, "outlook": [], "perl": 0, "yum": 0, "gcc": 0, "c": [0, 1], "pkgconfig": 0, "poppler": 0, "devel": 0, "homebrew": 0, "run": [0, 1], "termin": 0, "brew": 0, "microsoft": 1, "visual": 0, "studio": 0, "tool": 0, "anaconda": 0, "distribut": 0, "navig": 0, "creat": [0, 1], "new": [0, 1], "click": 0, "plai": 0, "button": 0, "open": [0, 1], "leav": 0, "conda": 0, "forg": 0, "configur": 0, "your": [0, 1], "id": [0, 1], "project": [0, 1], "In": 0, "pip3": 0, "u": 0, "If": [0, 1], "would": [], "abl": [], "ll": [], "need": [0, 1], "modul": 0, "which": 1, "msgconvert": 0, "standard": 0, "rfc": 0, "822": 0, "format": 0, "make": [0, 1], "easi": 1, "becaus": 1, "thei": 1, "have": 1, "abov": 1, "instruct": 1, "On": [], "rhel": [], "cento": [], "base": 1, "perlbrew": [], "local": 1, "copi": 1, "within": [], "user": [0, 1], "home": [], "similar": 1, "how": 1, "why": [], "initi": 1, "take": 1, "while": [], "don": 1, "t": 1, "risk": [], "break": [], "process": [], "onc": [], "cpan": [], "few": [], "minut": [], "complet": 1, "readi": 1, "inbox": 0, "get": 0, "start": 0, "practic": 0, "index": 0, "search": 0, "page": 0, "through": 1, "authent": 1, "yaramail": 1, "custom": 1, "instal": 1, "depend": 1, "strongli": 1, "develop": 1, "store": 1, "maintain": 1, "sampl": 1, "privat": 1, "git": 1, "repositori": 1, "github": 1, "great": 1, "reason": 1, "control": 1, "track": 1, "who": 1, "made": 1, "what": [0, 1], "chang": 1, "when": [0, 1], "rollback": 1, "should": 1, "pull": 1, "fresh": 1, "ci": 1, "cd": 1, "workflow": 1, "test": 1, "against": 1, "collect": 1, "product": 1, "vital": 1, "continu": 1, "real": 1, "world": 1, "safe": 1, "been": 1, "sent": [0, 1], "exist": 1, "effect": 1, "regress": 1, "materi": 1, "kept": 1, "master": 1, "branch": 1, "ani": [0, 1], "done": 1, "s": 1, "fork": 1, "alwai": 1, "ad": 1, "adjust": 1, "content": 0, "commit": 1, "trigger": 1, "request": 1, "review": 1, "propos": 1, "squash": 1, "merg": 1, "upstream": 1, "file": [0, 1], "api": 1, "provid": 1, "specif": 1, "design": 1, "To": 1, "look": 1, "document": 1, "learn": 1, "about": [0, 1], "from_trusted_domain": 1, "function": 1, "result": [0, 1], "dkim": 1, "dmarc": 1, "verifi": 1, "so": [0, 1], "receiv": 1, "mail": [0, 1], "server": 1, "third": 1, "parti": 1, "log": 1, "prove": 1, "spoof": 1, "most": 1, "servic": 1, "365": 1, "gmail": 1, "singl": 1, "By": 1, "multipl": 1, "avoid": 1, "attack": 1, "add": 1, "own": 1, "reach": 1, "destin": 1, "postfix": 1, "doe": 1, "allow_multiple_authentication_result": 1, "true": 1, "split": 1, "method": 1, "even": 1, "signatur": 1, "present": [], "use_authentication_results_origin": 1, "gatewai": 1, "origin": 1, "proofpoint": 1, "cisco": 1, "ironport": 1, "solut": 1, "abnorm": 1, "For": 1, "anoth": 1, "layer": 1, "defens": 1, "sender": 1, "flexabl": 1, "known": 1, "could": 1, "ensur": 1, "url": 1, "vendor": 1, "all_urls_example_vendor": 1, "style": 1, "comment": 1, "one": [0, 1], "after": 1, "organ": 1, "arbitrari": 1, "ha": 1, "more": 1, "context": 1, "mean": 1, "author": 1, "sean": 1, "whalen": 1, "date": 1, "2022": 1, "07": 1, "13": 1, "categori": 1, "descript": 1, "com": 1, "defin": 1, "These": 1, "byte": 1, "regular": 1, "express": 1, "ascii": 1, "wide": 1, "ignor": 1, "case": 1, "http": 1, "nocas": 1, "example_url": 1, "condit": 1, "total": 1, "imperson": [], "top": 1, "execut": 1, "classic": 1, "social": 1, "engin": 1, "techniqu": 1, "organis": 1, "fulli": 1, "implement": 1, "prevent": 1, "peopl": 1, "still": 1, "displai": 1, "regex": 1, "handi": 1, "varieti": 1, "variat": 1, "someth": 1, "begin": 1, "subject": 1, "let": 1, "know": 1, "came": 1, "extern": 1, "untrust": 1, "leverag": 1, "board": 1, "member": 1, "except": 1, "deal": 1, "exempt": 1, "cannot": 1, "altern": 1, "approach": 1, "previous": 1, "mention": 1, "analyz": 1, "exec_imperson": 1, "14": 1, "employe": 1, "planet": 1, "hubert": 1, "prof": 1, "lessor": 1, "farnsworth": 1, "professor": 1, "phil": 1, "ip": 1, "j": 1, "fry": 1, "philip": 1, "ext": 1, "s1": 1, "essor": [], "s2": 1, "herm": 1, "conrad": 1, "s3": 1, "turanga": 1, "leela": 1, "s4": 1, "ami": 1, "wong": 1, "s5": 1, "except_slug": 1, "brain": 1, "slug": 1, "fundrais": 1, "except_": 1, "veri": 1, "simpl": 1, "classifi": 1, "capabl": 1, "much": 1, "complex": 1, "read": 1, "over": 1, "resourc": 1, "often": 1, "send": [0, 1], "market": 1, "i": 1, "e": 1, "signific": 1, "contributor": 1, "alert": 1, "fatigu": 1, "those": 1, "reduc": 1, "nois": 1, "note": 1, "word": 1, "phrase": 1, "common": 1, "across": 1, "differ": [0, 1], "campaign": 1, "busi": 1, "industri": 1, "discount": 1, "trial": 1, "coupon": 1, "webinar": 1, "subscrib": 1, "roi": 1, "offer": 1, "price": 1, "cost": 1, "Then": 1, "statement": 1, "boolean": 1, "logic": 1, "previou": 1, "count": 1, "term": 1, "buzzword": 1, "threshold": 1, "occur": 1, "lower": 1, "meet": 1, "bulk": 1, "tend": 1, "least": 1, "sever": 1, "link": 1, "mayb": 1, "imag": 1, "find": 1, "right": 1, "mai": 1, "reduct": 1, "well": 1, "worth": 1, "effort": 1, "here": 1, "code": 1, "import": 1, "json": [], "logger": 1, "getlogg": 1, "def": 1, "beautify_report": [], "dump": [], "2": 0, "escalate_to_incident_respons": 1, "reported_email": 1, "prioriti": 1, "todo": 1, "do": 1, "malicious_verdict": 1, "credenti": 1, "harvest": 1, "fraud": 1, "load": 1, "trusted_domains_fil": 1, "n": 1, "try": 1, "error": 1, "f": 1, "1": 1, "fetch": 1, "thank": 1, "verdict": 1, "parsed_email": 1, "yara_match": 1, "assum": [], "everi": [], "append": 1, "len": 1, "0": 1, "close": 1, "ticket": 1, "move": 1, "folder": [0, 1], "elif": 1, "tell": 1, "address": 1, "spam": 1, "filter": 1, "delet": 1, "high": 1, "els": 1, "normal": 1, "than": 0, "whe": 1, "submit": 1, "stronger": 1, "ruleset": 1, "type": 1, "info": 1, "escal": 1, "full": 1, "middl": 1, "publicli": 1, "trade": 1, "compani": 1, "sec": 1, "searchabl": 1, "edgar": 1, "hugh": 1, "cyberchef": 1, "quickli": 1, "m": 1, "warn": 1, "_rule": 0, "skip_auth_check": 1, "offici": 0, "unfortun": 0, "pypi": 0, "did": 0, "non": 0, "password": 0, "protect": 0, "save": 0, "proprietari": 0, "ol": 0, "msg": 0, "extens": 0, "There": 0, "attempt": 0, "encount": 0, "howev": 0, "convers": 0, "isn": [], "perfect": [], "embed": [], "rtf": [], "anomali": 0, "introduc": 0, "them": [], "unsuit": 0, "forens": 0, "drag": 0, "drop": 0, "desktop": 0, "draft": 0, "download": 0, "step": 0, "alreadi": 0, "dure": 0, "analysi": 0, "actual": 0, "without": 0, "worri": 0, "malici": 1, "As": 1, "demonstr": 1, "sometim": 1, "iso": 1, "although": 1, "small": 1, "legitim": 1, "larg": 1, "disk": 1, "commonli": 1, "bootabl": 1, "oper": 1, "system": 1, "rang": 1, "hundr": 1, "megabyt": 1, "gigabyt": 1, "size": 1, "smaller": 1, "payload": 1, "sequenc": 1, "particular": 1, "usual": 1, "call": 1, "magic": 1, "wikipedia": 1, "43": 1, "44": 1, "30": 1, "31": 1, "inform": 1, "special": 1, "fiiles": 1, "small_iso": 1, "21": 1, "discript": 1, "indentifi": 1, "files": 1, "100mb": 1, "effici": 1, "being": 1, "filesystem": 1}, "objects": {"": [[0, 0, 0, "-", "yaramail"]], "yaramail": [[0, 1, 1, "", "MailScanner"]], "yaramail.MailScanner": [[0, 2, 1, "", "scan_email"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"]}, "titleterms": {"welcom": 0, "yaramail": 0, "s": 0, "document": 0, "featur": 0, "api": 0, "cli": 0, "instal": 0, "system": 0, "depend": 0, "debian": 0, "ubuntu": 0, "friend": 0, "fedora": 0, "red": 0, "hat": 0, "maco": 0, "window": 0, "work": [], "msg": [], "file": [], "content": 1, "indic": 0, "tabl": 0, "autom": 1, "phish": 1, "report": 1, "inbox": 1, "triag": 1, "get": 1, "start": 1, "practic": 1, "exampl": 1, "check": 1, "an": 1, "email": [0, 1], "trust": 1, "malici": [], "junk": 1, "put": 1, "all": 1, "togeth": 1, "further": 0, "read": 0, "sampl": 0, "outlook": 0, "client": 0, "microsoft": 0, "web": 0, "access": 0, "owa": 0, "imperson": 1, "attach": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})